{"ast":null,"code":"import _regeneratorRuntime from\"/Users/denis/Desktop/projects/movies-app/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/denis/Desktop/projects/movies-app/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/denis/Desktop/projects/movies-app/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/denis/Desktop/projects/movies-app/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/denis/Desktop/projects/movies-app/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/denis/Desktop/projects/movies-app/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/Users/denis/Desktop/projects/movies-app/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import React,{Component}from\"react\";import{IMAGES_API,VIDEO_API}from\"../../tools/keys\";import{apiGetRequest}from\"../../api/api\";import YouTube from\"react-youtube\";import ReactPlayer from\"react-player\";import MovieDetails from\"./parts/MovieDetails\";var Movie=/*#__PURE__*/function(_Component){_inherits(Movie,_Component);function Movie(){var _this;_classCallCheck(this,Movie);_this=_possibleConstructorReturn(this,_getPrototypeOf(Movie).call(this));_this.handleMouseEnter=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var timeout;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:timeout=setTimeout(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_this.setState({active:true,z_index:999999});_context.next=3;return _this.getMovieDetails();case 3:_this.getVideo();case 4:case\"end\":return _context.stop();}}},_callee);})),500);_this.setState({timeout:timeout});case 2:case\"end\":return _context2.stop();}}},_callee2);}));_this.getMovieDetails=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var movie,api;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:movie=_this.props.movie;api=\"movie/\".concat(movie.id);_context3.next=4;return apiGetRequest(api).then(function(res){if(res){_this.setState({movie_details:res});}});case 4:case\"end\":return _context3.stop();}}},_callee3);}));_this.handleMouseOut=function(){window.clearTimeout(_this.state.timeout);_this.setState({active:false,video:false,show_video:false});setTimeout(function(){_this.setState({z_index:0});},100);};_this.handleSelect=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(ref){var element;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_this.props.handleMovieSelect();element=document.querySelector(\"#movie__element--active\");setTimeout(function(){element.scrollIntoView({behavior:\"smooth\",block:\"start\",inline:'nearest'});},350);case 3:case\"end\":return _context4.stop();}}},_callee4);}));return function(_x){return _ref4.apply(this,arguments);};}();_this.getVideo=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(){var video,movie,api;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:video=_this.state.video;movie=_this.props.movie;api=\"movie/\".concat(movie.id,\"/videos\");if(!video){_context5.next=7;break;}_this.setState({video:video});_context5.next=9;break;case 7:_context5.next=9;return apiGetRequest(api).then(function(res){_this.setState({video:res&&res.results[0]?res.results[0].key:\"\"});});case 9:case\"end\":return _context5.stop();}}},_callee5);}));_this.onReady=function(){_this.setState({show_video:true});};_this.state={};return _this;}_createClass(Movie,[{key:\"render\",value:function render(){var _this2=this;var ref=React.createRef();var _this$props=this.props,movie=_this$props.movie,selected=_this$props.selected;var _this$state=this.state,active=_this$state.active,z_index=_this$state.z_index,video=_this$state.video,show_video=_this$state.show_video,movie_details=_this$state.movie_details;var opts={playerVars:{// https://developers.google.com/youtube/player_parameters\nautoplay:video?1:0,controls:0}};return React.createElement(\"div\",{id:active?\"movie__element--active\":\"\",style:{zIndex:z_index},onMouseEnter:function onMouseEnter(){return _this2.handleMouseEnter();},onMouseLeave:function onMouseLeave(){return _this2.handleMouseOut();},onClick:function onClick(){return _this2.handleSelect(ref);},className:\"movie__element\"},React.createElement(\"aside\",{ref:ref,className:\"movie__offset\"}),video&&active?React.createElement(\"div\",{id:show_video?\"video__wrapper--active\":\"\",className:\"video__wrapper\"},React.createElement(ReactPlayer,{onBufferEnd:this.onReady,className:\"video\",url:\"\".concat(VIDEO_API).concat(video),playing:true})):\"\",React.createElement(\"img\",{style:{opacity:show_video?0:1},src:\"\".concat(IMAGES_API,\"/\").concat(movie.poster_path),alt:\"\"}),active?React.createElement(MovieDetails,{movie_details:movie_details,movie:movie}):'');}}]);return Movie;}(Component);export default Movie;","map":{"version":3,"sources":["/Users/denis/Desktop/projects/movies-app/client/src/components/movies/Movie.jsx"],"names":["React","Component","IMAGES_API","VIDEO_API","apiGetRequest","YouTube","ReactPlayer","MovieDetails","Movie","handleMouseEnter","timeout","setTimeout","setState","active","z_index","getMovieDetails","getVideo","movie","props","api","id","then","res","movie_details","handleMouseOut","window","clearTimeout","state","video","show_video","handleSelect","ref","handleMovieSelect","element","document","querySelector","scrollIntoView","behavior","block","inline","results","key","onReady","createRef","selected","opts","playerVars","autoplay","controls","zIndex","opacity","poster_path"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { IMAGES_API, VIDEO_API } from \"../../tools/keys\";\nimport { apiGetRequest } from \"../../api/api\";\nimport YouTube from \"react-youtube\";\nimport ReactPlayer from \"react-player\";\nimport MovieDetails from \"./parts/MovieDetails\";\n\n\nclass Movie extends Component {\n  constructor() {\n    super();\n    this.state = {};\n  }\n\n  handleMouseEnter = async () => {\n    const timeout = setTimeout(async () => {\n      this.setState({\n        active: true,\n        z_index: 999999,\n      });\n     await this.getMovieDetails()\n     this.getVideo();\n    }, 500);\n    this.setState({\n      timeout,\n    });\n  };\n\n  getMovieDetails = async () => {\n      const {movie} = this.props\n    const api = `movie/${movie.id}`\n   await apiGetRequest(api).then(res => {\n        if(res){\n            this.setState({\n                movie_details:res\n            })\n        }\n   })\n  }\n  handleMouseOut = () => {\n    window.clearTimeout(this.state.timeout);\n\n    this.setState({\n      active: false,\n      video: false,\n      show_video: false,\n    });\n\n    setTimeout(() => {\n      this.setState({\n        z_index: 0,\n      });\n    }, 100);\n  };\n  handleSelect = async (ref) => {\n    this.props.handleMovieSelect();\n\n    var element = document.querySelector(\"#movie__element--active\");\n   setTimeout(() => {\n    element.scrollIntoView({\n      behavior: \"smooth\",\n      block: \"start\",\n      inline: 'nearest'\n    });\n   }, 350);\n\n   \n  };\n\n  getVideo = async () => {\n    const { video } = this.state;\n    const { movie } = this.props;\n    const api = `movie/${movie.id}/videos`;\n    if (video) {\n      this.setState({\n        video,\n      });\n    } else {\n      await apiGetRequest(api).then((res) => {\n        this.setState({\n          video: res && res.results[0] ? res.results[0].key : \"\",\n        });\n      });\n    }\n  };\n  onReady = () => {\n    this.setState({\n      show_video: true,\n    });\n  };\n  render() {\n    const ref = React.createRef();\n    const { movie, selected } = this.props;\n    const { active, z_index, video, show_video, movie_details } = this.state;\n\n    const opts = {\n      playerVars: {\n        // https://developers.google.com/youtube/player_parameters\n        autoplay: video ? 1 : 0,\n        controls: 0,\n      },\n    };\n    return (\n      <div\n        id={active   ? \"movie__element--active\" : \"\"}\n      \n        style={{\n          zIndex: z_index,\n        }}\n      \n        onMouseEnter={() => this.handleMouseEnter()}\n        onMouseLeave={() => this.handleMouseOut()}\n        onClick={() => this.handleSelect(ref)}\n        className=\"movie__element\"\n      >\n        <aside \n         ref = {ref}\n        className=\"movie__offset\"></aside>\n        {video && active ? (\n          <div\n            id={show_video ? \"video__wrapper--active\" : \"\"}\n            className=\"video__wrapper\"\n          >\n            <ReactPlayer\n              onBufferEnd={this.onReady}\n              className=\"video\"\n              url={`${VIDEO_API}${video}`}\n              playing\n            />\n          </div>\n        ) : (\n          \"\"\n        )}\n\n        <img\n          style={{\n            opacity: show_video ? 0 : 1,\n          }}\n          src={`${IMAGES_API}/${movie.poster_path}`}\n          alt=\"\"\n        />\n      {active  ?  <MovieDetails \n        movie_details = {movie_details}\n        movie = {movie}\n      /> : ''}\n      </div>\n    );\n  }\n}\n\nexport default Movie;\n"]},"metadata":{},"sourceType":"module"}