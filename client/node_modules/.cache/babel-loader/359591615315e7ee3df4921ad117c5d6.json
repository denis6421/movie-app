{"ast":null,"code":"import _regeneratorRuntime from\"/Users/denis/Desktop/projects/movies-app/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/denis/Desktop/projects/movies-app/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/denis/Desktop/projects/movies-app/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/denis/Desktop/projects/movies-app/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/denis/Desktop/projects/movies-app/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/denis/Desktop/projects/movies-app/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/Users/denis/Desktop/projects/movies-app/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import React,{Component}from\"react\";import{connect}from\"react-redux\";import*as actions from\"../../../../actions/actions\";import{withRouter}from\"react-router-dom\";import CloseIcon from\"@material-ui/icons/Close\";import{apiGetRequest}from\"../../../../api/api\";import MoviewPopupOverview from\"./MoviewPopupOverview\";import MoviePopupDetails from\"./MoviePopupDetails\";import MoviePopupRelated from\"./MoviePopupRelated\";var buttons=[\"OVERVIEW\",\"RELATED\",\"DETAILS\"];var MoviePopup=/*#__PURE__*/function(_Component){_inherits(MoviePopup,_Component);function MoviePopup(){var _this;_classCallCheck(this,MoviePopup);_this=_possibleConstructorReturn(this,_getPrototypeOf(MoviePopup).call(this));_this.getData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(id){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_this.setState({movie:{},video:''});_context.next=3;return _this.getMovie(id);case 3:_this.getCredits(id);_this.getRelated(id);_this.setState({section:\"OVERVIEW\"});case 6:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();_this.getVideo=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(id){var api;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:api=\"movie/\".concat(id,\"/videos\");_context2.next=3;return apiGetRequest(api).then(function(res){setTimeout(function(){_this.setState({video:res&&res.results[0]?res.results[0].key:\"\"});},400);});case 3:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref2.apply(this,arguments);};}();_this.getMovie=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(movie_id){var api,res;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:api=\"movie/\".concat(movie_id);_context3.next=3;return apiGetRequest(api);case 3:res=_context3.sent;if(res){_this.setState({movie:res});}case 5:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x3){return _ref3.apply(this,arguments);};}();_this.getRelated=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(movie_id){var api,res;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:api=\"movie/\".concat(movie_id,\"/similar\");_context4.next=3;return apiGetRequest(api);case 3:res=_context4.sent;if(res){_this.setState({similar:res.results,loaded:true});}case 5:case\"end\":return _context4.stop();}}},_callee4);}));return function(_x4){return _ref4.apply(this,arguments);};}();_this.getCredits=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(movie_id){var api,res;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:api=\"movie/\".concat(movie_id,\"/credits\");_context5.next=3;return apiGetRequest(api);case 3:res=_context5.sent;if(res){_this.setState({credits:res.cast,loaded:true});}case 5:case\"end\":return _context5.stop();}}},_callee5);}));return function(_x5){return _ref5.apply(this,arguments);};}();_this.close=function(){_this.setState({loaded:false,video:\"\"});setTimeout(function(){_this.props.closePreview();},200);};_this.changeSection=function(m){_this.setState({section:m});};_this.state={section:\"OVERVIEW\",movie:{}};return _this;}_createClass(MoviePopup,[{key:\"componentWillMount\",value:function componentWillMount(){var _this2=this;var selected_movie=this.props.selected_movie;setTimeout(function(){_this2.setState({loaded:true});},50);setTimeout(function(){_this2.getData(selected_movie);},300);}},{key:\"componentWillReceiveProps\",value:function(){var _componentWillReceiveProps=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(nextProps){return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:if(nextProps.selected_movie!==this.props.selected_movie){this.getData(nextProps.selected_movie);}case 1:case\"end\":return _context6.stop();}}},_callee6,this);}));function componentWillReceiveProps(_x6){return _componentWillReceiveProps.apply(this,arguments);}return componentWillReceiveProps;}()},{key:\"render\",value:function render(){var _this3=this;var _this$state=this.state,loaded=_this$state.loaded,section=_this$state.section,movie=_this$state.movie,credits=_this$state.credits,similar=_this$state.similar,video=_this$state.video;var _this$props=this.props,selected_movie=_this$props.selected_movie,size=_this$props.size,mobile=_this$props.mobile;return React.createElement(\"div\",{id:loaded?\"movie__popup--active\":\"\",className:\"movie__popup\"},React.createElement(\"button\",{className:\"movie__popup__close\",onClick:function onClick(){return _this3.close();}},React.createElement(CloseIcon,null)),React.createElement(MoviewPopupOverview,{movie:movie,video:video,selected_movie:selected_movie,active:section===\"OVERVIEW\",getVideo:function getVideo(){return _this3.getVideo(selected_movie);},mobile:mobile}),React.createElement(\"div\",{style:{opacity:section===\"OVERVIEW\"?0:1,pointerEvents:section!==\"OVERVIEW\"?\"all\":\"none\"},className:\"movie__popup__sections\"},React.createElement(\"aside\",{className:\"movie__popup__sections__shadow\"}),React.createElement(\"header\",null,movie.title),section===\"DETAILS\"?React.createElement(MoviePopupDetails,{credits:credits,movie:movie}):section===\"RELATED\"?React.createElement(MoviePopupRelated,{size:size,getData:this.getData,similar:similar,movie_id:selected_movie,updateParent:this.props.updateParent}):''),React.createElement(\"section\",{className:\"movie__popup__actions flex__start\"},buttons&&buttons.length>0?buttons.map(function(m,i){return React.createElement(\"button\",{style:{borderBottom:section===m?\"5px solid red\":\"\"},onClick:function onClick(){return _this3.changeSection(m);},key:i},m);}):\"\"));}}]);return MoviePopup;}(Component);function mapStateToProps(_ref6){var global=_ref6.global;return{global:global};}export default withRouter(connect(mapStateToProps,actions)(MoviePopup));","map":{"version":3,"sources":["/Users/denis/Desktop/projects/movies-app/client/src/components/movies/parts/movie-preview/MoviePopup.jsx"],"names":["React","Component","connect","actions","withRouter","CloseIcon","apiGetRequest","MoviewPopupOverview","MoviePopupDetails","MoviePopupRelated","buttons","MoviePopup","getData","id","setState","movie","video","getMovie","getCredits","getRelated","section","getVideo","api","then","res","setTimeout","results","key","movie_id","similar","loaded","credits","cast","close","props","closePreview","changeSection","m","state","selected_movie","nextProps","size","mobile","opacity","pointerEvents","title","updateParent","length","map","i","borderBottom","mapStateToProps","global"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { connect } from \"react-redux\";\nimport * as actions from \"../../../../actions/actions\";\nimport { withRouter } from \"react-router-dom\";\nimport CloseIcon from \"@material-ui/icons/Close\";\nimport { apiGetRequest } from \"../../../../api/api\";\nimport MoviewPopupOverview from \"./MoviewPopupOverview\";\nimport MoviePopupDetails from \"./MoviePopupDetails\";\nimport MoviePopupRelated from \"./MoviePopupRelated\";\n\nconst buttons = [\"OVERVIEW\", \"RELATED\", \"DETAILS\"];\nclass MoviePopup extends Component {\n  constructor() {\n    super();\n    this.state = {\n      section: \"OVERVIEW\",\n      movie: {},\n    };\n  }\n\n  componentWillMount() {\n    const { selected_movie } = this.props;\n    setTimeout(() => {\n      this.setState({\n        loaded: true,\n      });\n    }, 50);\n    setTimeout(() => {\n      this.getData(selected_movie);\n    }, 300);\n  }\n\n  async componentWillReceiveProps(nextProps) {\n    if (nextProps.selected_movie !== this.props.selected_movie) {\n      this.getData(nextProps.selected_movie);\n    }\n   \n  }\n\n  getData = async (id) => {\n    this.setState({\n      movie:{},\n      video:''\n    })\n    await this.getMovie(id);\n    this.getCredits(id);\n    this.getRelated(id);\n      this.setState({\n        section: \"OVERVIEW\",\n      });\n  };\n  getVideo = async (id) => {\n      const api = `movie/${id}/videos`;\n      await apiGetRequest(api).then((res) => {\n       setTimeout(() => {\n        this.setState({\n          video: res && res.results[0] ? res.results[0].key : \"\",\n        });\n       }, 400);\n      });\n   \n\n  };\n\n  getMovie = async (movie_id) => {\n    const api = `movie/${movie_id}`;\n    const res = await apiGetRequest(api);\n    if (res) {\n      this.setState({\n        movie: res,\n      });\n    }\n  };\n  getRelated = async (movie_id) => {\n    const api = `movie/${movie_id}/similar`;\n    const res = await apiGetRequest(api);\n    if (res) {\n      this.setState({\n        similar: res.results,\n        loaded: true,\n      });\n    }\n  };\n\n  getCredits = async (movie_id) => {\n    const api = `movie/${movie_id}/credits`;\n    const res = await apiGetRequest(api);\n    if (res) {\n      this.setState({\n        credits: res.cast,\n        loaded: true,\n      });\n    }\n  };\n  close = () => {\n    this.setState({\n      loaded: false,\n      video: \"\",\n      \n    });\n    setTimeout(() => {\n      this.props.closePreview();\n    }, 200);\n  };\n\n  changeSection = (m) => {\n    this.setState({\n      section: m,\n    });\n  };\n  render() {\n    const { loaded, section, movie, credits, similar, video } = this.state;\n    const { selected_movie , size, mobile} = this.props;\n\n    return (\n      <div id={loaded ? \"movie__popup--active\" : \"\"} className=\"movie__popup\">\n        <button className=\"movie__popup__close\" onClick={() => this.close()}>\n          <CloseIcon />\n        </button>\n\n        <MoviewPopupOverview\n          movie={movie}\n          video = {video}\n          selected_movie = {selected_movie}\n          active={section === \"OVERVIEW\"}\n          getVideo = {() => this.getVideo(selected_movie)}\n          mobile = {mobile}\n        />\n        <div\n          style={{\n            opacity: section === \"OVERVIEW\" ? 0 : 1,\n            pointerEvents: section !== \"OVERVIEW\" ? \"all\" : \"none\",\n          }}\n          className=\"movie__popup__sections\"\n        >\n          <aside className=\"movie__popup__sections__shadow\"></aside>\n          <header>{movie.title}</header>\n          {section === \"DETAILS\" ? (\n            <MoviePopupDetails \n           \n            credits={credits} movie={movie} />\n          ) : section === \"RELATED\" ? (\n            <MoviePopupRelated\n            size = {size}\n              getData={this.getData}\n              similar={similar}\n              movie_id={selected_movie}\n              updateParent={this.props.updateParent}\n            />\n          ) : ''}\n        </div>\n        <section className=\"movie__popup__actions flex__start\">\n          {buttons && buttons.length > 0\n            ? buttons.map((m, i) => {\n                return (\n                  <button\n                    style={{\n                      borderBottom: section === m ? \"5px solid red\" : \"\",\n                    }}\n                    onClick={() => this.changeSection(m)}\n                    key={i}\n                  >\n                    {m}\n                  </button>\n                );\n              })\n            : \"\"}\n        </section>\n      </div>\n    );\n  }\n}\n\nfunction mapStateToProps({ global }) {\n  return { global };\n}\n\nexport default withRouter(connect(mapStateToProps, actions)(MoviePopup));\n"]},"metadata":{},"sourceType":"module"}