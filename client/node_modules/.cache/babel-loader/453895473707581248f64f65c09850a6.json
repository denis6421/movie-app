{"ast":null,"code":"var _jsxFileName = \"/Users/denis/Desktop/projects/movies-app/client/src/components/movies/Movie.jsx\";\nimport React, { Component } from \"react\";\nimport { IMAGES_API, VIDEO_API } from \"../../tools/keys\";\nimport { apiGetRequest } from \"../../api/api\";\nimport ReactPlayer from \"react-player\";\nimport MovieDetails from \"./parts/MovieDetails\";\nimport MuteBtn from \"../parts/MuteBtn\";\nimport { connect } from 'react-redux';\nimport * as actions from '../../actions/actions';\nimport Fade from 'react-reveal/Fade';\n\nclass Movie extends Component {\n  constructor() {\n    super();\n\n    this.handleMouseEnter = async () => {\n      const timeout = setTimeout(async () => {\n        this.setState({\n          active: true,\n          z_index: 999999\n        });\n        this.getVideo();\n      }, 350);\n      this.setState({\n        timeout\n      });\n    };\n\n    this.handleMouseOut = () => {\n      window.clearTimeout(this.state.timeout);\n      this.setState({\n        active: false,\n        video: false,\n        show_video: false\n      });\n      setTimeout(() => {\n        this.setState({\n          z_index: 0\n        });\n      }, 200);\n    };\n\n    this.getVideo = async () => {\n      const video = this.state.video;\n      const movie = this.props.movie;\n      const api = \"movie/\".concat(movie.id, \"/videos\");\n\n      if (video) {\n        this.setState({\n          video\n        });\n      } else {\n        await apiGetRequest(api).then(res => {\n          this.setState({\n            video: res && res.results[0] ? res.results[0].key : \"\"\n          });\n        });\n      }\n    };\n\n    this.onReady = () => {\n      this.setState({\n        show_video: true\n      });\n    };\n\n    this.handleVideoEnded = () => {\n      this.setState({\n        video: false,\n        show_video: false\n      });\n    };\n\n    this.handleSelect = () => {\n      this.props.handleMovieSelect();\n      this.setState({\n        show_video: false,\n        video: false,\n        active: false\n      });\n    };\n\n    this.state = {};\n  }\n\n  render() {\n    const _this$props = this.props,\n          movie = _this$props.movie,\n          selected = _this$props.selected,\n          selected_movie = _this$props.selected_movie,\n          mobile = _this$props.mobile;\n    const _this$state = this.state,\n          z_index = _this$state.z_index,\n          video = _this$state.video,\n          show_video = _this$state.show_video,\n          movie_details = _this$state.movie_details,\n          active = _this$state.active,\n          img_loaded = _this$state.img_loaded;\n    const movie_muted = this.props.global.movie_muted;\n    return React.createElement(Fade, {\n      clear: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 92\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      ref: el => this.yourElement = el,\n      id: active ? \"movie__element--active\" : \"\",\n      style: {\n        zIndex: z_index,\n        border: selected_movie ? '2px solid white' : ''\n      },\n      onMouseEnter: () => !mobile && !selected ? this.handleMouseEnter() : '',\n      onMouseLeave: () => this.handleMouseOut(),\n      onClick: e => {\n        e.stopPropagation();\n        this.handleSelect();\n      },\n      className: \"movie__element\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95\n      },\n      __self: this\n    }, video && !selected ? React.createElement(React.Fragment, null, React.createElement(\"div\", {\n      id: show_video ? \"video__wrapper--active\" : \"\",\n      className: \"video__wrapper\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 110\n      },\n      __self: this\n    }, React.createElement(ReactPlayer, {\n      onBufferEnd: this.onReady,\n      className: \"video\",\n      url: \"\".concat(VIDEO_API).concat(video),\n      playing: true,\n      onEnded: this.handleVideoEnded,\n      muted: movie_muted,\n      onError: () => this.handleVideoEnded,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 115\n      },\n      __self: this\n    })), show_video ? React.createElement(MuteBtn, {\n      muted: movie_muted,\n      mute: () => this.props.updateGlobalReducer('movie_muted', !movie_muted),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 125\n      },\n      __self: this\n    }) : '') : \"\", React.createElement(\"img\", {\n      style: {\n        opacity: show_video || !img_loaded ? 0 : 1\n      },\n      src: \"\".concat(IMAGES_API, \"/\").concat(movie.poster_path),\n      onLoad: () => this.setState({\n        img_loaded: true\n      }),\n      alt: \"\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 134\n      },\n      __self: this\n    }), active && !selected ? React.createElement(MovieDetails, {\n      show_video: show_video,\n      movie_details: movie_details,\n      movie: movie,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 144\n      },\n      __self: this\n    }) : \"\", React.createElement(\"div\", {\n      style: {\n        opacity: selected_movie ? 1 : ''\n      },\n      className: \"movie__arrow__box\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 153\n      },\n      __self: this\n    }, React.createElement(\"aside\", {\n      className: \"movie__arrow\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 158\n      },\n      __self: this\n    }))));\n  }\n\n}\n\nfunction mapStateToProps({\n  global\n}) {\n  return {\n    global\n  };\n}\n\nexport default connect(mapStateToProps, actions)(Movie);","map":{"version":3,"sources":["/Users/denis/Desktop/projects/movies-app/client/src/components/movies/Movie.jsx"],"names":["React","Component","IMAGES_API","VIDEO_API","apiGetRequest","ReactPlayer","MovieDetails","MuteBtn","connect","actions","Fade","Movie","constructor","handleMouseEnter","timeout","setTimeout","setState","active","z_index","getVideo","handleMouseOut","window","clearTimeout","state","video","show_video","movie","props","api","id","then","res","results","key","onReady","handleVideoEnded","handleSelect","handleMovieSelect","render","selected","selected_movie","mobile","movie_details","img_loaded","movie_muted","global","el","yourElement","zIndex","border","e","stopPropagation","updateGlobalReducer","opacity","poster_path","mapStateToProps"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { IMAGES_API, VIDEO_API } from \"../../tools/keys\";\nimport { apiGetRequest } from \"../../api/api\";\nimport ReactPlayer from \"react-player\";\nimport MovieDetails from \"./parts/MovieDetails\";\nimport MuteBtn from \"../parts/MuteBtn\";\nimport { connect } from 'react-redux'\nimport * as actions from '../../actions/actions'\nimport Fade from 'react-reveal/Fade';\n\n\n\nclass Movie extends Component {\n  constructor() {\n    super();\n    this.state = {};\n  }\n\n  handleMouseEnter = async () => {\n    const timeout = setTimeout(async () => {\n      this.setState({\n        active: true,\n        z_index: 999999,\n      });\n      this.getVideo();\n    }, 350);\n    this.setState({\n      timeout,\n    });\n  };\n\n  handleMouseOut = () => {\n    window.clearTimeout(this.state.timeout);\n    this.setState({\n      active: false,\n      video: false,\n      show_video: false,\n    });\n    setTimeout(() => {\n      this.setState({\n        z_index: 0,\n      });\n    }, 200);\n  };\n\n  getVideo = async () => {\n    const { video } = this.state;\n    const { movie } = this.props;\n    const api = `movie/${movie.id}/videos`;\n    if (video) {\n      this.setState({\n        video,\n      });\n    } else {\n      await apiGetRequest(api).then((res) => {\n        this.setState({\n          video: res && res.results[0] ? res.results[0].key : \"\",\n        });\n      });\n    }\n  };\n\n\n  onReady = () => {\n    this.setState({\n      show_video: true,\n    });\n  };\n  handleVideoEnded = () => {\n    this.setState({\n      video: false,\n      show_video: false,\n    });\n  };\n  handleSelect = () => {\n    this.props.handleMovieSelect();\n    this.setState({\n      show_video: false,\n      video: false,\n      active:false\n    });\n  };\n\n \n  render() {\n    const { movie , selected, selected_movie, mobile, } = this.props;\n    const {z_index, video, show_video, movie_details, active, img_loaded } = this.state;\n    const {movie_muted} = this.props.global\n    \n   \n    return (\n     <Fade\n     clear\n     >\n        <div\n       \n        ref={(el) => this.yourElement = el}\n        id={active   ? \"movie__element--active\" : \"\"}\n        style={{\n          zIndex: z_index,\n          border:selected_movie ? '2px solid white'  :''\n        }}\n        onMouseEnter={() => !mobile && !selected?  this.handleMouseEnter() : ''}\n        onMouseLeave={() => this.handleMouseOut()}\n        onClick={(e) =>{ e.stopPropagation();  this.handleSelect()}}\n        className=\"movie__element\"\n      >\n        {video && !selected? (\n          <>\n          <div\n            id={show_video ? \"video__wrapper--active\" : \"\"}\n            className=\"video__wrapper\"\n          >\n       \n            <ReactPlayer\n              onBufferEnd={this.onReady}\n              className=\"video\"\n              url={`${VIDEO_API}${video}`}\n              playing\n              onEnded={this.handleVideoEnded}\n              muted = {movie_muted}\n              onError = {() => this.handleVideoEnded}\n            /> \n          </div>\n         {show_video ?  <MuteBtn\n             muted = {movie_muted}\n             mute = {() => this.props.updateGlobalReducer('movie_muted', !movie_muted) }\n             /> : ''}\n          </>\n        ) : (\n          \"\"\n        )}\n\n        <img\n          style={{\n            opacity:show_video || !img_loaded ? 0 : 1,\n           \n          }}\n          src={`${IMAGES_API}/${movie.poster_path}`}\n          onLoad = {() => this.setState({img_loaded:true})}\n          alt=\"\"\n        />\n        {active && !selected? (\n          <MovieDetails\n            show_video={show_video}\n            movie_details={movie_details}\n            movie={movie}\n          />\n        ) : (\n          \"\"\n        )}\n          \n         <div \n         style ={{\n           opacity:selected_movie  ?1  :''\n         }}\n         className=\"movie__arrow__box\">\n           <aside className='movie__arrow'></aside>\n         </div>\n      </div>\n     </Fade>\n    );\n  }\n}\n\nfunction mapStateToProps({ global }) {\n  return { global }\n}\n\nexport default (connect(mapStateToProps, actions)(Movie))"]},"metadata":{},"sourceType":"module"}