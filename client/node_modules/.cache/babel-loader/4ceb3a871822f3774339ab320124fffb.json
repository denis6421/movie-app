{"ast":null,"code":"import _regeneratorRuntime from\"/Users/denis/Desktop/projects/movies-app/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/denis/Desktop/projects/movies-app/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/denis/Desktop/projects/movies-app/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/denis/Desktop/projects/movies-app/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/denis/Desktop/projects/movies-app/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/denis/Desktop/projects/movies-app/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/Users/denis/Desktop/projects/movies-app/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _toConsumableArray from\"/Users/denis/Desktop/projects/movies-app/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import React,{Component}from\"react\";import\"./movies.css\";import{apiGetRequest}from\"../../api/api\";import MoviesList from\"./MoviesList\";import MoviePage from\"../movie-page/MoviePage\";import{withRouter}from\"react-router-dom\";var generateList=function generateList(list){var arr=[];list.forEach(function(element){return arr=[].concat(_toConsumableArray(arr),_toConsumableArray(element));});return arr;};export var generateArrays=function generateArrays(list,pending_movies,size){var new_list=[].concat(_toConsumableArray(list),_toConsumableArray(pending_movies));var pending=[];var movies=[];for(var i=0;i<new_list.length;i+=size){var sliced=new_list.slice(i,i+size);if(sliced.length===size){movies.push(sliced);}else{pending.push.apply(pending,_toConsumableArray(sliced));}}return{movies:movies,pending:pending};};var Movies=/*#__PURE__*/function(_Component){_inherits(Movies,_Component);function Movies(){var _this;_classCallCheck(this,Movies);_this=_possibleConstructorReturn(this,_getPrototypeOf(Movies).call(this));_this.updateSize=function(){var _this$state=_this.state,movies=_this$state.movies,pending_movies=_this$state.pending_movies;var width=window.innerWidth;var size=_this.state.size;var list=[];var obj={};if(width<=1500&&size!==5){size=5;list=generateList(movies);obj=generateArrays(list,pending_movies,size);_this.setState({movies:obj.movies,pending_movies:obj.pending,size:size});}if(width<=1200&&size!==4)size=4;list=generateList(movies);obj=generateArrays(list,pending_movies,size);_this.setState({movies:obj.movies,pending_movies:obj.pending,size:size});if(width<=650&&size!==2)size=2;list=generateList(movies);obj=generateArrays(list,pending_movies,size);_this.setState({movies:obj.movies,pending_movies:obj.pending,size:size});if(width>1500&&size!==6)size=6;_this.setState({size:size});list=generateList(movies);obj=generateArrays(list,pending_movies,size);_this.setState({movies:obj.movies,pending_movies:obj.pending});_this.setState({page_loaded:true});};_this.loadElements=function(page){var size=_this.state.size;var api=\"movie/popular\";try{apiGetRequest(api,page).then(function(res){_this.handleMovies(res.results,size);});}catch(error){}};_this.handleMovies=function(list,size){var _this$state2=_this.state,movies=_this$state2.movies,pending_movies=_this$state2.pending_movies;var obj=generateArrays(list,pending_movies,size);_this.setState({movies:[].concat(_toConsumableArray(movies),_toConsumableArray(obj.movies)),pending_movies:obj.pending});};_this.goToMoviePage=function(selected_movie){_this.setState({selected_movie:selected_movie});window.history.pushState(\"/\",\"/\",\"/\".concat(selected_movie));};_this.state={has_more:true,movies:[],page:1,size:6,pending_movies:[]};return _this;}_createClass(Movies,[{key:\"componentDidMount\",value:function(){var _componentDidMount=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _this2=this;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setTimeout(function(){_this2.setState({stop:true});},400);window.addEventListener(\"resize\",this.updateSize);this.updateSize();case 3:case\"end\":return _context.stop();}}},_callee,this);}));function componentDidMount(){return _componentDidMount.apply(this,arguments);}return componentDidMount;}()},{key:\"render\",value:function render(){var _this$state3=this.state,movies=_this$state3.movies,stop=_this$state3.stop,page_loaded=_this$state3.page_loaded,selected_movie=_this$state3.selected_movie;console.log(selected_movie);return page_loaded?React.createElement(\"div\",{className:\"movies\"},React.createElement(MoviesList,{goToMoviePage:this.goToMoviePage,stop:stop,movies:movies,loadElements:this.loadElements}),selected_movie?React.createElement(MoviePage,{close:this.goToMoviePage}):''):\"\";}}]);return Movies;}(Component);export default withRouter(Movies);","map":{"version":3,"sources":["/Users/denis/Desktop/projects/movies-app/client/src/components/movies/Movies.jsx"],"names":["React","Component","apiGetRequest","MoviesList","MoviePage","withRouter","generateList","list","arr","forEach","element","generateArrays","pending_movies","size","new_list","pending","movies","i","length","sliced","slice","push","Movies","updateSize","state","width","window","innerWidth","obj","setState","page_loaded","loadElements","page","api","then","res","handleMovies","results","error","goToMoviePage","selected_movie","history","pushState","has_more","setTimeout","stop","addEventListener","console","log"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport \"./movies.css\";\nimport { apiGetRequest } from \"../../api/api\";\nimport MoviesList from \"./MoviesList\";\nimport MoviePage from \"../movie-page/MoviePage\";\nimport { withRouter } from \"react-router-dom\";\n\nconst generateList = (list) => {\n  let arr = [];\n  list.forEach((element) => {\n    return (arr = [...arr, ...element]);\n  });\n  return arr;\n};\n\nexport const generateArrays = (list, pending_movies, size) => {\n  let new_list = [...list, ...pending_movies];\n  let pending = [];\n  var movies = [];\n\n  for (var i = 0; i < new_list.length; i += size) {\n    let sliced = new_list.slice(i, i + size);\n    if (sliced.length === size) {\n      movies.push(sliced);\n    } else {\n      pending.push(...sliced);\n    }\n  }\n  return {\n    movies,\n    pending,\n  };\n};\nclass Movies extends Component {\n  constructor() {\n    super();\n    this.state = {\n      has_more: true,\n      movies: [],\n      page: 1,\n      size: 6,\n      pending_movies: [],\n    };\n  }\n  async componentDidMount() {\n    setTimeout(() => {\n      this.setState({\n        stop: true,\n      });\n    }, 400);\n    window.addEventListener(\"resize\", this.updateSize);\n    this.updateSize();\n  }\n\n  updateSize = () => {\n    const { movies, pending_movies } = this.state;\n    const width = window.innerWidth;\n    let size = this.state.size;\n    let list = [];\n    let obj = {};\n\n    if (width <= 1500 && size !== 5) {\n      size = 5;\n      list = generateList(movies);\n      obj = generateArrays(list, pending_movies, size);\n      this.setState({\n        movies: obj.movies,\n        pending_movies: obj.pending,\n        size,\n      });\n    }\n\n    if (width <= 1200 && size !== 4) size = 4;\n    list = generateList(movies);\n    obj = generateArrays(list, pending_movies, size);\n    this.setState({\n      movies: obj.movies,\n      pending_movies: obj.pending,\n      size,\n    });\n\n    if (width <= 650 && size !== 2) size = 2;\n    list = generateList(movies);\n    obj = generateArrays(list, pending_movies, size);\n    this.setState({\n      movies: obj.movies,\n      pending_movies: obj.pending,\n      size,\n    });\n\n    if (width > 1500 && size !== 6) size = 6;\n    this.setState({\n      size,\n    });\n    list = generateList(movies);\n    obj = generateArrays(list, pending_movies, size);\n    this.setState({\n      movies: obj.movies,\n      pending_movies: obj.pending,\n    });\n\n    this.setState({\n      page_loaded: true,\n    });\n  };\n\n  loadElements = (page) => {\n    const { size } = this.state;\n    const api = \"movie/popular\";\n    try {\n      apiGetRequest(api, page).then((res) => {\n        this.handleMovies(res.results, size);\n      });\n    } catch (error) {}\n  };\n\n  handleMovies = (list, size) => {\n    const { movies, pending_movies } = this.state;\n    const obj = generateArrays(list, pending_movies, size);\n    this.setState({\n      movies: [...movies, ...obj.movies],\n      pending_movies: obj.pending,\n    });\n  };\n  goToMoviePage = (selected_movie) => {\n    this.setState({\n      selected_movie\n    })\n    window.history.pushState(\"/\", \"/\", `/${selected_movie}`);\n  }\n\n  render() {\n    const { movies, stop, page_loaded, selected_movie } = this.state;\n    console.log(selected_movie)\n    return page_loaded ? (\n      <div className=\"movies\">\n        <MoviesList\n        goToMoviePage = {this.goToMoviePage}\n          stop={stop}\n          movies={movies}\n          loadElements={this.loadElements}\n        />\n       {selected_movie ? <MoviePage\n       close = {this.goToMoviePage}\n       /> : ''}\n      </div>\n    ) : (\n      \"\"\n    );\n  }\n}\n\nexport default withRouter(Movies);\n"]},"metadata":{},"sourceType":"module"}