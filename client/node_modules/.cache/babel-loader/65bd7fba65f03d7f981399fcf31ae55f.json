{"ast":null,"code":"import _regeneratorRuntime from\"/Users/denis/Desktop/projects/movies-app/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/denis/Desktop/projects/movies-app/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/denis/Desktop/projects/movies-app/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/denis/Desktop/projects/movies-app/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/denis/Desktop/projects/movies-app/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/denis/Desktop/projects/movies-app/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/Users/denis/Desktop/projects/movies-app/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import React,{Component}from\"react\";import{connect}from\"react-redux\";import*as actions from\"../../../../actions/actions\";import{withRouter}from\"react-router-dom\";import CloseIcon from\"@material-ui/icons/Close\";import{apiGetRequest}from\"../../../../api/api\";import MoviewPopupOverview from\"./MoviewPopupOverview\";import MoviePopupDetails from\"./MoviePopupDetails\";import MoviePopupRelated from\"./MoviePopupRelated\";var buttons=[\"OVERVIEW\",\"RELATED\",\"DETAILS\"];var MoviePopup=/*#__PURE__*/function(_Component){_inherits(MoviePopup,_Component);function MoviePopup(){var _this;_classCallCheck(this,MoviePopup);_this=_possibleConstructorReturn(this,_getPrototypeOf(MoviePopup).call(this));_this.getData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(id){var mobile;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:mobile=_this.props.mobile;_this.setState({movie:{},video:''});_context.next=4;return _this.getMovie(id);case 4:if(!mobile){_this.getCredits(id);_this.getRelated(id);_this.setState({section:\"OVERVIEW\"});}case 5:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();_this.getVideo=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(id){var api;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:api=\"movie/\".concat(id,\"/videos\");_context2.next=3;return apiGetRequest(api).then(function(res){setTimeout(function(){_this.setState({video:res&&res.results[0]?res.results[0].key:\"\"});},400);});case 3:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref2.apply(this,arguments);};}();_this.getMovie=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(movie_id){var api,res;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:api=\"movie/\".concat(movie_id);_context3.next=3;return apiGetRequest(api);case 3:res=_context3.sent;if(res){_this.setState({movie:res});}case 5:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x3){return _ref3.apply(this,arguments);};}();_this.getRelated=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(movie_id){var api,res;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:api=\"movie/\".concat(movie_id,\"/similar\");_context4.next=3;return apiGetRequest(api);case 3:res=_context4.sent;if(res){_this.setState({similar:res.results,loaded:true});}case 5:case\"end\":return _context4.stop();}}},_callee4);}));return function(_x4){return _ref4.apply(this,arguments);};}();_this.getCredits=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(movie_id){var api,res;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:api=\"movie/\".concat(movie_id,\"/credits\");_context5.next=3;return apiGetRequest(api);case 3:res=_context5.sent;if(res){_this.setState({credits:res.cast,loaded:true});}case 5:case\"end\":return _context5.stop();}}},_callee5);}));return function(_x5){return _ref5.apply(this,arguments);};}();_this.close=function(){_this.setState({loaded:false,video:\"\"});setTimeout(function(){_this.props.closePreview();},200);};_this.changeSection=function(m){_this.setState({section:m});};_this.state={section:\"OVERVIEW\",movie:{}};return _this;}_createClass(MoviePopup,[{key:\"componentWillMount\",value:function componentWillMount(){var _this2=this;var _this$props=this.props,selected_movie=_this$props.selected_movie,mobile=_this$props.mobile;setTimeout(function(){_this2.setState({loaded:true});},20);setTimeout(function(){_this2.getData(selected_movie);_this2.setState({show_content:true});},mobile?100:700);}},{key:\"componentWillReceiveProps\",value:function(){var _componentWillReceiveProps=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(nextProps){return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:if(nextProps.selected_movie!==this.props.selected_movie){this.getData(nextProps.selected_movie);}case 1:case\"end\":return _context6.stop();}}},_callee6,this);}));function componentWillReceiveProps(_x6){return _componentWillReceiveProps.apply(this,arguments);}return componentWillReceiveProps;}()},{key:\"render\",value:function render(){var _this3=this;var _this$state=this.state,loaded=_this$state.loaded,section=_this$state.section,movie=_this$state.movie,credits=_this$state.credits,similar=_this$state.similar,video=_this$state.video,show_content=_this$state.show_content;var _this$props2=this.props,selected_movie=_this$props2.selected_movie,size=_this$props2.size,mobile=_this$props2.mobile;return React.createElement(\"div\",{id:loaded?\"movie__popup--active\":\"\",className:\"movie__popup\"},show_content?React.createElement(React.Fragment,null,React.createElement(\"button\",{className:\"movie__popup__close\",onClick:function onClick(){return _this3.close();}},React.createElement(CloseIcon,null)),React.createElement(MoviewPopupOverview,{movie:movie,video:video,selected_movie:selected_movie,active:section===\"OVERVIEW\",getVideo:function getVideo(){return _this3.getVideo(selected_movie);},mobile:mobile}),React.createElement(\"div\",{style:{opacity:section===\"OVERVIEW\"?0:1,pointerEvents:section!==\"OVERVIEW\"?\"all\":\"none\"},className:\"movie__popup__sections\"},React.createElement(\"aside\",{className:\"movie__popup__sections__shadow\"}),React.createElement(\"header\",null,movie.title),section===\"DETAILS\"?React.createElement(MoviePopupDetails,{credits:credits,movie:movie}):section===\"RELATED\"?React.createElement(MoviePopupRelated,{size:size,getData:this.getData,similar:similar,movie_id:selected_movie,updateParent:this.props.updateParent}):''),React.createElement(\"section\",{className:\"movie__popup__actions flex__start\"},buttons&&buttons.length>0?buttons.map(function(m,i){return React.createElement(\"button\",{style:{borderBottom:section===m?\"5px solid red\":\"\"},onClick:function onClick(){return _this3.changeSection(m);},key:i},m);}):\"\")):'');}}]);return MoviePopup;}(Component);function mapStateToProps(_ref6){var global=_ref6.global;return{global:global};}export default withRouter(connect(mapStateToProps,actions)(MoviePopup));","map":{"version":3,"sources":["/Users/denis/Desktop/projects/movies-app/client/src/components/movies/parts/movie-preview/MoviePopup.jsx"],"names":["React","Component","connect","actions","withRouter","CloseIcon","apiGetRequest","MoviewPopupOverview","MoviePopupDetails","MoviePopupRelated","buttons","MoviePopup","getData","id","mobile","props","setState","movie","video","getMovie","getCredits","getRelated","section","getVideo","api","then","res","setTimeout","results","key","movie_id","similar","loaded","credits","cast","close","closePreview","changeSection","m","state","selected_movie","show_content","nextProps","size","opacity","pointerEvents","title","updateParent","length","map","i","borderBottom","mapStateToProps","global"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { connect } from \"react-redux\";\nimport * as actions from \"../../../../actions/actions\";\nimport { withRouter } from \"react-router-dom\";\nimport CloseIcon from \"@material-ui/icons/Close\";\nimport { apiGetRequest } from \"../../../../api/api\";\nimport MoviewPopupOverview from \"./MoviewPopupOverview\";\nimport MoviePopupDetails from \"./MoviePopupDetails\";\nimport MoviePopupRelated from \"./MoviePopupRelated\";\n\nconst buttons = [\"OVERVIEW\", \"RELATED\", \"DETAILS\"];\nclass MoviePopup extends Component {\n  constructor() {\n    super();\n    this.state = {\n      section: \"OVERVIEW\",\n      movie: {},\n    };\n  }\n\n  componentWillMount() {\n    const { selected_movie, mobile } = this.props;\n    setTimeout(() => {\n      this.setState({\n        loaded: true,\n      });\n    }, 20);\n    setTimeout(() => {\n      this.getData(selected_movie);\n      this.setState({\n        show_content:true\n      })\n    },mobile ? 100  :  700);\n  }\n\n  async componentWillReceiveProps(nextProps) {\n    if (nextProps.selected_movie !== this.props.selected_movie) {\n      this.getData(nextProps.selected_movie);\n    }\n   \n  }\n\n  getData = async (id) => {\n    const {mobile} = this.props\n    this.setState({\n      movie:{},\n      video:''\n    })\n    await this.getMovie(id);\n   if(!mobile){\n    this.getCredits(id);\n    this.getRelated(id);\n      this.setState({\n        section: \"OVERVIEW\",\n      });\n   }\n  };\n  getVideo = async (id) => {\n      const api = `movie/${id}/videos`;\n      await apiGetRequest(api).then((res) => {\n       setTimeout(() => {\n        this.setState({\n          video: res && res.results[0] ? res.results[0].key : \"\",\n        });\n       }, 400);\n      });\n   \n\n  };\n\n  getMovie = async (movie_id) => {\n    const api = `movie/${movie_id}`;\n    const res = await apiGetRequest(api);\n    if (res) {\n      this.setState({\n        movie: res,\n      });\n    }\n  };\n  getRelated = async (movie_id) => {\n    const api = `movie/${movie_id}/similar`;\n    const res = await apiGetRequest(api);\n    if (res) {\n      this.setState({\n        similar: res.results,\n        loaded: true,\n      });\n    }\n  };\n\n  getCredits = async (movie_id) => {\n    const api = `movie/${movie_id}/credits`;\n    const res = await apiGetRequest(api);\n    if (res) {\n      this.setState({\n        credits: res.cast,\n        loaded: true,\n      });\n    }\n  };\n  close = () => {\n    this.setState({\n      loaded: false,\n      video: \"\",\n      \n    });\n    setTimeout(() => {\n      this.props.closePreview();\n    }, 200);\n  };\n\n  changeSection = (m) => {\n    this.setState({\n      section: m,\n    });\n  };\n  render() {\n    const { loaded, section, movie, credits, similar, video, show_content } = this.state;\n    const { selected_movie , size, mobile} = this.props;\n\n    return (\n      <div id={loaded ? \"movie__popup--active\" : \"\"} className=\"movie__popup\">\n      {show_content ?  <>\n       <button className=\"movie__popup__close\" onClick={() => this.close()}>\n          <CloseIcon />\n        </button>\n\n        <MoviewPopupOverview\n          movie={movie}\n          video = {video}\n          selected_movie = {selected_movie}\n          active={section === \"OVERVIEW\"}\n          getVideo = {() => this.getVideo(selected_movie)}\n          mobile = {mobile}\n        />\n        <div\n          style={{\n            opacity: section === \"OVERVIEW\" ? 0 : 1,\n            pointerEvents: section !== \"OVERVIEW\" ? \"all\" : \"none\",\n          }}\n          className=\"movie__popup__sections\"\n        >\n          <aside className=\"movie__popup__sections__shadow\"></aside>\n          <header>{movie.title}</header>\n          {section === \"DETAILS\" ? (\n            <MoviePopupDetails \n           \n            credits={credits} movie={movie} />\n          ) : section === \"RELATED\" ? (\n            <MoviePopupRelated\n            size = {size}\n              getData={this.getData}\n              similar={similar}\n              movie_id={selected_movie}\n              updateParent={this.props.updateParent}\n            />\n          ) : ''}\n        </div>\n        <section className=\"movie__popup__actions flex__start\">\n          {buttons && buttons.length > 0\n            ? buttons.map((m, i) => {\n                return (\n                  <button\n                    style={{\n                      borderBottom: section === m ? \"5px solid red\" : \"\",\n                    }}\n                    onClick={() => this.changeSection(m)}\n                    key={i}\n                  >\n                    {m}\n                  </button>\n                );\n              })\n            : \"\"}\n        </section>\n       </> : ''}\n      </div>\n    );\n  }\n}\n\nfunction mapStateToProps({ global }) {\n  return { global };\n}\n\nexport default withRouter(connect(mapStateToProps, actions)(MoviePopup));\n"]},"metadata":{},"sourceType":"module"}