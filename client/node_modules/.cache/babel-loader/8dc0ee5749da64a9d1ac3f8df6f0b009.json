{"ast":null,"code":"var _jsxFileName = \"/Users/denis/Desktop/projects/movies-app/src/components/movies/Movies.jsx\";\nimport React, { Component } from \"react\";\nimport \"./movies.css\";\nimport { apiGetRequest } from \"../../api/api\";\nimport MoviesList from \"./MoviesList\";\nimport MoviePage from \"../movie-page/MoviePage\";\nimport { withRouter } from \"react-router-dom\";\n\nconst generateList = list => {\n  let arr = [];\n  list.forEach(element => {\n    return arr = [...arr, ...element];\n  });\n  return arr;\n};\n\nexport const generateArrays = (list, pending_movies, size) => {\n  let new_list = [...list, ...pending_movies];\n  let pending = [];\n  var movies = [];\n\n  for (var i = 0; i < new_list.length; i += size) {\n    let sliced = new_list.slice(i, i + size);\n\n    if (sliced.length === size) {\n      movies.push(sliced);\n    } else {\n      pending.push(...sliced);\n    }\n  }\n\n  return {\n    movies,\n    pending\n  };\n};\n\nclass Movies extends Component {\n  constructor() {\n    super();\n\n    this.updateSize = () => {\n      const _this$state = this.state,\n            movies = _this$state.movies,\n            pending_movies = _this$state.pending_movies;\n      const width = window.innerWidth;\n      let size = this.state.size;\n      let list = [];\n      let obj = {};\n\n      if (width <= 1500 && size !== 5) {\n        size = 5;\n        list = generateList(movies);\n        obj = generateArrays(list, pending_movies, size);\n        this.setState({\n          movies: obj.movies,\n          pending_movies: obj.pending,\n          size\n        });\n      }\n\n      if (width <= 1200 && size !== 4) size = 4;\n      list = generateList(movies);\n      obj = generateArrays(list, pending_movies, size);\n      this.setState({\n        movies: obj.movies,\n        pending_movies: obj.pending,\n        size\n      });\n      if (width <= 650 && size !== 2) size = 2;\n      list = generateList(movies);\n      obj = generateArrays(list, pending_movies, size);\n      this.setState({\n        movies: obj.movies,\n        pending_movies: obj.pending,\n        size\n      });\n      if (width > 1500 && size !== 6) size = 6;\n      this.setState({\n        size\n      });\n      list = generateList(movies);\n      obj = generateArrays(list, pending_movies, size);\n      this.setState({\n        movies: obj.movies,\n        pending_movies: obj.pending\n      });\n      this.setState({\n        page_loaded: true\n      });\n    };\n\n    this.loadElements = page => {\n      const size = this.state.size;\n      const api = \"movie/popular\";\n\n      try {\n        apiGetRequest(api, page).then(res => {\n          this.handleMovies(res.results, size);\n        });\n      } catch (error) {}\n    };\n\n    this.handleMovies = (list, size) => {\n      const _this$state2 = this.state,\n            movies = _this$state2.movies,\n            pending_movies = _this$state2.pending_movies;\n      const obj = generateArrays(list, pending_movies, size);\n      this.setState({\n        movies: [...movies, ...obj.movies],\n        pending_movies: obj.pending\n      });\n    };\n\n    this.goToMoviePage = selected_movie => {\n      this.setState({\n        selected_movie\n      });\n      window.history.pushState(\"/\", \"/\", \"/\".concat(selected_movie));\n    };\n\n    this.state = {\n      has_more: true,\n      movies: [],\n      page: 1,\n      size: 6,\n      pending_movies: []\n    };\n  }\n\n  async componentDidMount() {\n    setTimeout(() => {\n      this.setState({\n        stop: true\n      });\n    }, 400);\n    window.addEventListener(\"resize\", this.updateSize);\n    this.updateSize();\n  }\n\n  render() {\n    const _this$state3 = this.state,\n          movies = _this$state3.movies,\n          stop = _this$state3.stop,\n          page_loaded = _this$state3.page_loaded,\n          selected_movie = _this$state3.selected_movie;\n    console.log(selected_movie);\n    return page_loaded ? React.createElement(\"div\", {\n      className: \"movies\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 136\n      },\n      __self: this\n    }, React.createElement(MoviesList, {\n      goToMoviePage: this.goToMoviePage,\n      stop: stop,\n      movies: movies,\n      loadElements: this.loadElements,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 137\n      },\n      __self: this\n    }), selected_movie ? React.createElement(MoviePage, {\n      close: this.goToMoviePage,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 143\n      },\n      __self: this\n    }) : '') : \"\";\n  }\n\n}\n\nexport default withRouter(Movies);","map":{"version":3,"sources":["/Users/denis/Desktop/projects/movies-app/src/components/movies/Movies.jsx"],"names":["React","Component","apiGetRequest","MoviesList","MoviePage","withRouter","generateList","list","arr","forEach","element","generateArrays","pending_movies","size","new_list","pending","movies","i","length","sliced","slice","push","Movies","constructor","updateSize","state","width","window","innerWidth","obj","setState","page_loaded","loadElements","page","api","then","res","handleMovies","results","error","goToMoviePage","selected_movie","history","pushState","has_more","componentDidMount","setTimeout","stop","addEventListener","render","console","log"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport \"./movies.css\";\nimport { apiGetRequest } from \"../../api/api\";\nimport MoviesList from \"./MoviesList\";\nimport MoviePage from \"../movie-page/MoviePage\";\nimport { withRouter } from \"react-router-dom\";\n\nconst generateList = (list) => {\n  let arr = [];\n  list.forEach((element) => {\n    return (arr = [...arr, ...element]);\n  });\n  return arr;\n};\n\nexport const generateArrays = (list, pending_movies, size) => {\n  let new_list = [...list, ...pending_movies];\n  let pending = [];\n  var movies = [];\n\n  for (var i = 0; i < new_list.length; i += size) {\n    let sliced = new_list.slice(i, i + size);\n    if (sliced.length === size) {\n      movies.push(sliced);\n    } else {\n      pending.push(...sliced);\n    }\n  }\n  return {\n    movies,\n    pending,\n  };\n};\nclass Movies extends Component {\n  constructor() {\n    super();\n    this.state = {\n      has_more: true,\n      movies: [],\n      page: 1,\n      size: 6,\n      pending_movies: [],\n    };\n  }\n  async componentDidMount() {\n    setTimeout(() => {\n      this.setState({\n        stop: true,\n      });\n    }, 400);\n    window.addEventListener(\"resize\", this.updateSize);\n    this.updateSize();\n  }\n\n  updateSize = () => {\n    const { movies, pending_movies } = this.state;\n    const width = window.innerWidth;\n    let size = this.state.size;\n    let list = [];\n    let obj = {};\n\n    if (width <= 1500 && size !== 5) {\n      size = 5;\n      list = generateList(movies);\n      obj = generateArrays(list, pending_movies, size);\n      this.setState({\n        movies: obj.movies,\n        pending_movies: obj.pending,\n        size,\n      });\n    }\n\n    if (width <= 1200 && size !== 4) size = 4;\n    list = generateList(movies);\n    obj = generateArrays(list, pending_movies, size);\n    this.setState({\n      movies: obj.movies,\n      pending_movies: obj.pending,\n      size,\n    });\n\n    if (width <= 650 && size !== 2) size = 2;\n    list = generateList(movies);\n    obj = generateArrays(list, pending_movies, size);\n    this.setState({\n      movies: obj.movies,\n      pending_movies: obj.pending,\n      size,\n    });\n\n    if (width > 1500 && size !== 6) size = 6;\n    this.setState({\n      size,\n    });\n    list = generateList(movies);\n    obj = generateArrays(list, pending_movies, size);\n    this.setState({\n      movies: obj.movies,\n      pending_movies: obj.pending,\n    });\n\n    this.setState({\n      page_loaded: true,\n    });\n  };\n\n  loadElements = (page) => {\n    const { size } = this.state;\n    const api = \"movie/popular\";\n    try {\n      apiGetRequest(api, page).then((res) => {\n        this.handleMovies(res.results, size);\n      });\n    } catch (error) {}\n  };\n\n  handleMovies = (list, size) => {\n    const { movies, pending_movies } = this.state;\n    const obj = generateArrays(list, pending_movies, size);\n    this.setState({\n      movies: [...movies, ...obj.movies],\n      pending_movies: obj.pending,\n    });\n  };\n  goToMoviePage = (selected_movie) => {\n    this.setState({\n      selected_movie\n    })\n    window.history.pushState(\"/\", \"/\", `/${selected_movie}`);\n  }\n\n  render() {\n    const { movies, stop, page_loaded, selected_movie } = this.state;\n    console.log(selected_movie)\n    return page_loaded ? (\n      <div className=\"movies\">\n        <MoviesList\n        goToMoviePage = {this.goToMoviePage}\n          stop={stop}\n          movies={movies}\n          loadElements={this.loadElements}\n        />\n       {selected_movie ? <MoviePage\n       close = {this.goToMoviePage}\n       /> : ''}\n      </div>\n    ) : (\n      \"\"\n    );\n  }\n}\n\nexport default withRouter(Movies);\n"]},"metadata":{},"sourceType":"module"}