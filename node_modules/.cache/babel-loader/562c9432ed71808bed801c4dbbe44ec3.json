{"ast":null,"code":"var _jsxFileName = \"/Users/denis/Desktop/projects/movies-app/client/src/components/movies/Movie.jsx\";\nimport React, { Component } from \"react\";\nimport { IMAGES_API, VIDEO_API } from \"../../tools/keys\";\nimport { apiGetRequest } from \"../../api/api\";\nimport ReactPlayer from \"react-player\";\nimport MovieDetails from \"./parts/MovieDetails\";\nimport MuteBtn from \"../parts/MuteBtn\";\nimport { connect } from \"react-redux\";\nimport * as actions from \"../../actions/actions\";\nimport Fade from \"react-reveal/Fade\";\n\nclass Movie extends Component {\n  constructor() {\n    super();\n\n    this.handleMouseEnter = async () => {\n      const timeout = setTimeout(async () => {\n        this.setState({\n          active: true,\n          z_index: 999999\n        });\n        this.getVideo();\n      }, 350);\n      this.setState({\n        timeout\n      });\n    };\n\n    this.handleMouseOut = () => {\n      window.clearTimeout(this.state.timeout);\n      this.setState({\n        active: false,\n        video: false,\n        show_video: false\n      });\n      setTimeout(() => {\n        this.setState({\n          z_index: 0\n        });\n      }, 200);\n    };\n\n    this.getVideo = async () => {\n      const video = this.state.video;\n      const movie = this.props.movie;\n      const api = \"movie/\".concat(movie.id, \"/videos\");\n\n      if (video) {\n        this.setState({\n          video\n        });\n      } else {\n        await apiGetRequest(api).then(res => {\n          this.setState({\n            video: res && res.results[0] ? res.results[0].key : \"\"\n          });\n        });\n      }\n    };\n\n    this.onReady = () => {\n      this.setState({\n        show_video: true\n      });\n    };\n\n    this.handleVideoEnded = () => {\n      this.setState({\n        video: false,\n        show_video: false\n      });\n    };\n\n    this.handleSelect = () => {\n      this.props.handleMovieSelect();\n      this.setState({\n        show_video: false,\n        video: false,\n        active: false\n      });\n    };\n\n    this.state = {};\n  }\n\n  render() {\n    const _this$props = this.props,\n          movie = _this$props.movie,\n          selected = _this$props.selected,\n          selected_movie = _this$props.selected_movie,\n          mobile = _this$props.mobile;\n    const _this$state = this.state,\n          z_index = _this$state.z_index,\n          video = _this$state.video,\n          show_video = _this$state.show_video,\n          movie_details = _this$state.movie_details,\n          active = _this$state.active,\n          img_loaded = _this$state.img_loaded;\n    const movie_muted = this.props.global.movie_muted;\n    return React.createElement(Fade, {\n      clear: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      ref: el => this.yourElement = el,\n      id: active ? \"movie__element--active\" : \"\",\n      style: {\n        zIndex: z_index,\n        border: selected_movie ? \"2px solid white\" : \"\"\n      },\n      onMouseEnter: () => !mobile && !selected ? this.handleMouseEnter() : \"\",\n      onMouseOut: () => this.handleMouseOut(),\n      onClick: e => {\n        e.stopPropagation();\n        this.handleSelect();\n      },\n      className: \"movie__element\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95\n      },\n      __self: this\n    }, video && !selected ? React.createElement(React.Fragment, null, React.createElement(\"div\", {\n      id: show_video ? \"video__wrapper--active\" : \"\",\n      className: \"video__wrapper\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 114\n      },\n      __self: this\n    }, React.createElement(ReactPlayer, {\n      onBufferEnd: this.onReady,\n      className: \"video\",\n      url: \"\".concat(VIDEO_API).concat(video),\n      playing: true,\n      onEnded: this.handleVideoEnded,\n      muted: movie_muted,\n      onError: () => this.handleVideoEnded,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118\n      },\n      __self: this\n    })), show_video ? React.createElement(MuteBtn, {\n      muted: movie_muted,\n      mute: () => this.props.updateGlobalReducer(\"movie_muted\", !movie_muted),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 129\n      },\n      __self: this\n    }) : \"\") : \"\", React.createElement(\"img\", {\n      style: {\n        opacity: show_video || !img_loaded ? 0 : 1\n      },\n      src: \"\".concat(IMAGES_API, \"/\").concat(movie.poster_path),\n      onLoad: () => this.setState({\n        img_loaded: true\n      }),\n      alt: \"\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 143\n      },\n      __self: this\n    }), active && !selected ? React.createElement(MovieDetails, {\n      show_video: show_video,\n      movie_details: movie_details,\n      movie: movie,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 152\n      },\n      __self: this\n    }) : \"\", React.createElement(\"div\", {\n      style: {\n        opacity: selected_movie ? 1 : \"\"\n      },\n      className: \"movie__arrow__box\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 161\n      },\n      __self: this\n    }, React.createElement(\"aside\", {\n      className: \"movie__arrow\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 167\n      },\n      __self: this\n    }))));\n  }\n\n}\n\nfunction mapStateToProps({\n  global\n}) {\n  return {\n    global\n  };\n}\n\nexport default connect(mapStateToProps, actions)(Movie);","map":{"version":3,"sources":["/Users/denis/Desktop/projects/movies-app/client/src/components/movies/Movie.jsx"],"names":["React","Component","IMAGES_API","VIDEO_API","apiGetRequest","ReactPlayer","MovieDetails","MuteBtn","connect","actions","Fade","Movie","constructor","handleMouseEnter","timeout","setTimeout","setState","active","z_index","getVideo","handleMouseOut","window","clearTimeout","state","video","show_video","movie","props","api","id","then","res","results","key","onReady","handleVideoEnded","handleSelect","handleMovieSelect","render","selected","selected_movie","mobile","movie_details","img_loaded","movie_muted","global","el","yourElement","zIndex","border","e","stopPropagation","updateGlobalReducer","opacity","poster_path","mapStateToProps"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { IMAGES_API, VIDEO_API } from \"../../tools/keys\";\nimport { apiGetRequest } from \"../../api/api\";\nimport ReactPlayer from \"react-player\";\nimport MovieDetails from \"./parts/MovieDetails\";\nimport MuteBtn from \"../parts/MuteBtn\";\nimport { connect } from \"react-redux\";\nimport * as actions from \"../../actions/actions\";\nimport Fade from \"react-reveal/Fade\";\n\nclass Movie extends Component {\n  constructor() {\n    super();\n    this.state = {};\n  }\n\n  handleMouseEnter = async () => {\n    const timeout = setTimeout(async () => {\n      this.setState({\n        active: true,\n        z_index: 999999,\n      });\n      this.getVideo();\n    }, 350);\n    this.setState({\n      timeout,\n    });\n  };\n\n  handleMouseOut = () => {\n    window.clearTimeout(this.state.timeout);\n    this.setState({\n      active: false,\n      video: false,\n      show_video: false,\n    });\n    setTimeout(() => {\n      this.setState({\n        z_index: 0,\n      });\n    }, 200);\n  };\n\n  getVideo = async () => {\n    const { video } = this.state;\n    const { movie } = this.props;\n    const api = `movie/${movie.id}/videos`;\n    if (video) {\n      this.setState({\n        video,\n      });\n    } else {\n      await apiGetRequest(api).then((res) => {\n        this.setState({\n          video: res && res.results[0] ? res.results[0].key : \"\",\n        });\n      });\n    }\n  };\n\n  onReady = () => {\n    this.setState({\n      show_video: true,\n    });\n  };\n  handleVideoEnded = () => {\n    this.setState({\n      video: false,\n      show_video: false,\n    });\n  };\n  handleSelect = () => {\n    this.props.handleMovieSelect();\n    this.setState({\n      show_video: false,\n      video: false,\n      active: false,\n    });\n  };\n\n  render() {\n    const { movie, selected, selected_movie, mobile } = this.props;\n    const {\n      z_index,\n      video,\n      show_video,\n      movie_details,\n      active,\n      img_loaded,\n    } = this.state;\n    const { movie_muted } = this.props.global;\n\n    return (\n      <Fade clear>\n        <div\n          ref={(el) => (this.yourElement = el)}\n          id={active ? \"movie__element--active\" : \"\"}\n          style={{\n            zIndex: z_index,\n            border: selected_movie ? \"2px solid white\" : \"\",\n          }}\n          onMouseEnter={() =>\n            !mobile && !selected ? this.handleMouseEnter() : \"\"\n          }\n          onMouseOut={() => this.handleMouseOut()}\n          onClick={(e) => {\n            e.stopPropagation();\n            this.handleSelect();\n          }}\n          className=\"movie__element\"\n        >\n          {video && !selected ? (\n            <>\n              <div\n                id={show_video ? \"video__wrapper--active\" : \"\"}\n                className=\"video__wrapper\"\n              >\n                <ReactPlayer\n                  onBufferEnd={this.onReady}\n                  className=\"video\"\n                  url={`${VIDEO_API}${video}`}\n                  playing\n                  onEnded={this.handleVideoEnded}\n                  muted={movie_muted}\n                  onError={() => this.handleVideoEnded}\n                />\n              </div>\n              {show_video ? (\n                <MuteBtn\n                  muted={movie_muted}\n                  mute={() =>\n                    this.props.updateGlobalReducer(\"movie_muted\", !movie_muted)\n                  }\n                />\n              ) : (\n                \"\"\n              )}\n            </>\n          ) : (\n            \"\"\n          )}\n\n          <img\n            style={{\n              opacity: show_video || !img_loaded ? 0 : 1,\n            }}\n            src={`${IMAGES_API}/${movie.poster_path}`}\n            onLoad={() => this.setState({ img_loaded: true })}\n            alt=\"\"\n          />\n          {active && !selected ? (\n            <MovieDetails\n              show_video={show_video}\n              movie_details={movie_details}\n              movie={movie}\n            />\n          ) : (\n            \"\"\n          )}\n\n          <div\n            style={{\n              opacity: selected_movie ? 1 : \"\",\n            }}\n            className=\"movie__arrow__box\"\n          >\n            <aside className=\"movie__arrow\"></aside>\n          </div>\n        </div>\n      </Fade>\n    );\n  }\n}\n\nfunction mapStateToProps({ global }) {\n  return { global };\n}\n\nexport default connect(mapStateToProps, actions)(Movie);\n"]},"metadata":{},"sourceType":"module"}