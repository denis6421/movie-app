{"ast":null,"code":"import _regeneratorRuntime from\"/Users/denis/Desktop/projects/movies-app/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/denis/Desktop/projects/movies-app/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/denis/Desktop/projects/movies-app/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/denis/Desktop/projects/movies-app/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/denis/Desktop/projects/movies-app/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/denis/Desktop/projects/movies-app/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/Users/denis/Desktop/projects/movies-app/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import React,{Component}from\"react\";import{IMAGES_API,VIDEO_API}from\"../../tools/keys\";import{apiGetRequest}from\"../../api/api\";import ReactPlayer from\"react-player\";import MovieDetails from\"./parts/MovieDetails\";import MuteBtn from\"../parts/MuteBtn\";import{connect}from\"react-redux\";import*as actions from\"../../actions/actions\";import Fade from\"react-reveal/Fade\";var Movie=/*#__PURE__*/function(_Component){_inherits(Movie,_Component);function Movie(){var _this;_classCallCheck(this,Movie);_this=_possibleConstructorReturn(this,_getPrototypeOf(Movie).call(this));_this.handleMouseEnter=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var timeout;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:timeout=setTimeout(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_this.setState({active:true,z_index:999999});_this.getVideo();case 2:case\"end\":return _context.stop();}}},_callee);})),350);_this.setState({timeout:timeout});case 2:case\"end\":return _context2.stop();}}},_callee2);}));_this.handleMouseOut=function(){window.clearTimeout(_this.state.timeout);setTimeout(function(){_this.setState({active:false,video:false,show_video:false,z_index:0});},200);};_this.getVideo=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var active,movie,api;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:active=_this.state.active;movie=_this.props.movie;api=\"movie/\".concat(movie.id,\"/videos\");if(!active){_context3.next=6;break;}_context3.next=6;return apiGetRequest(api).then(function(res){_this.setState({video:res&&res.results[0]?res.results[0].key:\"\"});});case 6:case\"end\":return _context3.stop();}}},_callee3);}));_this.onReady=function(){_this.setState({show_video:true});};_this.handleVideoEnded=function(){_this.setState({video:false,show_video:false});};_this.handleSelect=function(){_this.props.handleMovieSelect();_this.setState({show_video:false,video:false,active:false});};_this.state={};return _this;}_createClass(Movie,[{key:\"render\",value:function render(){var _this2=this;var _this$props=this.props,movie=_this$props.movie,selected=_this$props.selected,selected_movie=_this$props.selected_movie,mobile=_this$props.mobile;var _this$state=this.state,z_index=_this$state.z_index,video=_this$state.video,show_video=_this$state.show_video,movie_details=_this$state.movie_details,active=_this$state.active,img_loaded=_this$state.img_loaded;var movie_muted=this.props.global.movie_muted;return React.createElement(Fade,{clear:true},React.createElement(\"div\",{ref:function ref(el){return _this2.yourElement=el;},id:active?\"movie__element--active\":\"\",style:{zIndex:z_index,border:selected_movie?\"2px solid white\":\"\"},onMouseEnter:function onMouseEnter(){return!mobile&&!selected?_this2.handleMouseEnter():\"\";},onMouseLeave:function onMouseLeave(){return _this2.handleMouseOut();},onClick:function onClick(e){e.stopPropagation();_this2.handleSelect();},className:\"movie__element\"},video&&!selected?React.createElement(React.Fragment,null,React.createElement(\"div\",{id:show_video?\"video__wrapper--active\":\"\",className:\"video__wrapper\"},React.createElement(ReactPlayer,{onBufferEnd:this.onReady,className:\"video\",url:\"\".concat(VIDEO_API).concat(video),playing:true,onEnded:this.handleVideoEnded,muted:movie_muted,onError:function onError(){return _this2.handleVideoEnded;}})),show_video?React.createElement(MuteBtn,{muted:movie_muted,mute:function mute(){return _this2.props.updateGlobalReducer(\"movie_muted\",!movie_muted);}}):\"\"):\"\",React.createElement(\"img\",{style:{opacity:show_video||!img_loaded?0:1},src:\"\".concat(IMAGES_API,\"/\").concat(movie.poster_path),onLoad:function onLoad(){return _this2.setState({img_loaded:true});},alt:\"\"}),active&&!selected?React.createElement(MovieDetails,{show_video:show_video,movie_details:movie_details,movie:movie}):\"\",React.createElement(\"div\",{style:{opacity:selected_movie?1:\"\"},className:\"movie__arrow__box\"},React.createElement(\"aside\",{className:\"movie__arrow\"}))));}}]);return Movie;}(Component);function mapStateToProps(_ref4){var global=_ref4.global;return{global:global};}export default connect(mapStateToProps,actions)(Movie);","map":{"version":3,"sources":["/Users/denis/Desktop/projects/movies-app/client/src/components/movies/Movie.jsx"],"names":["React","Component","IMAGES_API","VIDEO_API","apiGetRequest","ReactPlayer","MovieDetails","MuteBtn","connect","actions","Fade","Movie","handleMouseEnter","timeout","setTimeout","setState","active","z_index","getVideo","handleMouseOut","window","clearTimeout","state","video","show_video","movie","props","api","id","then","res","results","key","onReady","handleVideoEnded","handleSelect","handleMovieSelect","selected","selected_movie","mobile","movie_details","img_loaded","movie_muted","global","el","yourElement","zIndex","border","e","stopPropagation","updateGlobalReducer","opacity","poster_path","mapStateToProps"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { IMAGES_API, VIDEO_API } from \"../../tools/keys\";\nimport { apiGetRequest } from \"../../api/api\";\nimport ReactPlayer from \"react-player\";\nimport MovieDetails from \"./parts/MovieDetails\";\nimport MuteBtn from \"../parts/MuteBtn\";\nimport { connect } from \"react-redux\";\nimport * as actions from \"../../actions/actions\";\nimport Fade from \"react-reveal/Fade\";\n\nclass Movie extends Component {\n  constructor() {\n    super();\n    this.state = {};\n  }\n\n  handleMouseEnter = async () => {\n    const timeout = setTimeout(async () => {\n      this.setState({\n        active: true,\n        z_index: 999999,\n      });\n      this.getVideo();\n    }, 350);\n    this.setState({\n      timeout,\n    });\n  };\n\n  handleMouseOut = () => {\n    window.clearTimeout(this.state.timeout);\n    setTimeout(() => {\n      this.setState({\n        active: false,\n        video: false,\n        show_video: false,\n        z_index: 0,\n      });\n    }, 200);\n \n  };\n\n  getVideo = async () => {\n    const { active } = this.state;\n    const { movie } = this.props;\n    const api = `movie/${movie.id}/videos`;\n  if(active){\n    await apiGetRequest(api).then((res) => {\n      this.setState({\n        video:  res && res.results[0] ? res.results[0].key : \"\",\n      });\n    });\n  }\n  };\n\n  onReady = () => {\n    this.setState({\n      show_video: true,\n    });\n  };\n  handleVideoEnded = () => {\n    this.setState({\n      video: false,\n      show_video: false,\n    });\n  };\n  handleSelect = () => {\n    this.props.handleMovieSelect();\n    this.setState({\n      show_video: false,\n      video: false,\n      active: false,\n    });\n  };\n\n  render() {\n    const { movie, selected, selected_movie, mobile } = this.props;\n    const {\n      z_index,\n      video,\n      show_video,\n      movie_details,\n      active,\n      img_loaded,\n    } = this.state;\n    const { movie_muted } = this.props.global;\n\n    return (\n      <Fade clear>\n        <div\n          ref={(el) => (this.yourElement = el)}\n          id={active ? \"movie__element--active\" : \"\"}\n          style={{\n            zIndex: z_index,\n            border: selected_movie ? \"2px solid white\" : \"\",\n          }}\n          onMouseEnter={() =>\n            !mobile && !selected ? this.handleMouseEnter() : \"\"\n          }\n          onMouseLeave={() => this.handleMouseOut()}\n          onClick={(e) => {\n            e.stopPropagation();\n            this.handleSelect();\n          }}\n          className=\"movie__element\"\n        >\n          {video && !selected ? (\n            <>\n              <div\n                id={show_video ? \"video__wrapper--active\" : \"\"}\n                className=\"video__wrapper\"\n              >\n                <ReactPlayer\n                  onBufferEnd={this.onReady}\n                  className=\"video\"\n                  url={`${VIDEO_API}${video}`}\n                  playing\n                  onEnded={this.handleVideoEnded}\n                  muted={movie_muted}\n                  onError={() => this.handleVideoEnded}\n                />\n              </div>\n              {show_video ? (\n                <MuteBtn\n                  muted={movie_muted}\n                  mute={() =>\n                    this.props.updateGlobalReducer(\"movie_muted\", !movie_muted)\n                  }\n                />\n              ) : (\n                \"\"\n              )}\n            </>\n          ) : (\n            \"\"\n          )}\n\n          <img\n            style={{\n              opacity: show_video || !img_loaded ? 0 : 1,\n            }}\n            src={`${IMAGES_API}/${movie.poster_path}`}\n            onLoad={() => this.setState({ img_loaded: true })}\n            alt=\"\"\n          />\n          {active && !selected ? (\n            <MovieDetails\n              show_video={show_video}\n              movie_details={movie_details}\n              movie={movie}\n            />\n          ) : (\n            \"\"\n          )}\n\n          <div\n            style={{\n              opacity: selected_movie ? 1 : \"\",\n            }}\n            className=\"movie__arrow__box\"\n          >\n            <aside className=\"movie__arrow\"></aside>\n          </div>\n        </div>\n      </Fade>\n    );\n  }\n}\n\nfunction mapStateToProps({ global }) {\n  return { global };\n}\n\nexport default connect(mapStateToProps, actions)(Movie);\n"]},"metadata":{},"sourceType":"module"}