{"ast":null,"code":"import _regeneratorRuntime from\"/Users/denis/Desktop/projects/movies-app/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/denis/Desktop/projects/movies-app/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/denis/Desktop/projects/movies-app/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/denis/Desktop/projects/movies-app/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/denis/Desktop/projects/movies-app/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/denis/Desktop/projects/movies-app/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/Users/denis/Desktop/projects/movies-app/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import React,{Component}from\"react\";import\"./movie-page.css\";import{MOVIES_ROUTE,MOVIE_ROUTE}from\"../../tools/routes\";import{withRouter}from\"react-router-dom\";import{connect}from\"react-redux\";import*as actions from\"../../actions/actions\";import MovieCredits from\"./sections/MovieCredits\";import MovieRelated from\"./sections/MovieRelated\";import MoviePageAbout from\"./parts/MoviePageAbout\";import{apiGetRequest}from\"../../api/api\";var MoviePage=/*#__PURE__*/function(_Component){_inherits(MoviePage,_Component);function MoviePage(){var _this;_classCallCheck(this,MoviePage);_this=_possibleConstructorReturn(this,_getPrototypeOf(MoviePage).call(this));_this.getMovieId=function(){var url=window.location.pathname.split('/');var movie_id=url[url.length-1]?url[url.length-1]:_this.props.match.params.id;return movie_id;};_this.getMovie=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(movie_id){var api,res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:api=\"movie/\".concat(movie_id);_context.next=3;return apiGetRequest(api);case 3:res=_context.sent;if(res){_this.setState({movie:res});}case 5:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();_this.getVideo=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(movie_id){var api;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:api=\"movie/\".concat(movie_id,\"/videos\");_context2.next=3;return apiGetRequest(api).then(function(res){_this.setState({video:res&&res.results[0]?res.results[0].key:\"\"});});case 3:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref2.apply(this,arguments);};}();_this.handleActiveSection=function(active_section){_this.setState({active_section:active_section});};_this.closePage=function(){_this.setState({active:false});setTimeout(function(){_this.props.close();window.history.pushState(\"/\",\"/\",\"/\");},300);};_this.back=function(){var from_movies=_this.props.from_movies;if(from_movies){_this.closePage();_this.props.updateGlobalReducer(\"pause_movie\",false);}else _this.props.history.push(MOVIES_ROUTE);};_this.changeMovie=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(id){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return _this.getMovie(id);case 2:setTimeout(function(){_this.getVideo(id);},400);_this.setState({movie_id:id});case 4:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x3){return _ref3.apply(this,arguments);};}();_this.state={movie:{}};return _this;}_createClass(MoviePage,[{key:\"componentWillMount\",value:function(){var _componentWillMount=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){var _this2=this;var _this$props,from_movies,selected_movie,movie_id;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_this$props=this.props,from_movies=_this$props.from_movies,selected_movie=_this$props.selected_movie;movie_id=this.getMovieId();if(from_movies){setTimeout(function(){_this2.setState({active:true});},50);}else{this.setState({active:true});}this.setState({movie_id:movie_id});_context4.next=6;return this.getMovie(movie_id);case 6:setTimeout(function(){_this2.getVideo(movie_id);},400);case 7:case\"end\":return _context4.stop();}}},_callee4,this);}));function componentWillMount(){return _componentWillMount.apply(this,arguments);}return componentWillMount;}()},{key:\"render\",value:function render(){var _this3=this;var _this$state=this.state,active=_this$state.active,movie=_this$state.movie,active_section=_this$state.active_section,movie_id=_this$state.movie_id,fade_out=_this$state.fade_out,video=_this$state.video;var actions=[{name:\"Reviews\",value:\"reviews\"},{name:\"Credits\",value:\"credits\"},{name:\"Related\",value:\"similar\"}];return React.createElement(\"div\",{id:active?\"movie__page--active\":\"\",className:\"movie__page\"},React.createElement(\"section\",{className:\"movie__page__overlay\"},\" \"),React.createElement(\"button\",{onClick:function onClick(){return _this3.back();}},\"X\"),React.createElement(MoviePageAbout,{fade_out:fade_out,movie_id:movie_id,movie:movie,video:video}),React.createElement(\"ul\",{className:\"movie__page__actions flex__center\"},actions.map(function(m,i){return React.createElement(\"li\",{onClick:function onClick(){return _this3.handleActiveSection(m.value);}},m.name);})),React.createElement(\"div\",{className:\"movie__page__content\"},active_section===\"credits\"?React.createElement(MovieCredits,{movie_id:movie_id}):active_section===\"similar\"?React.createElement(MovieRelated,{changeMovie:this.changeMovie,movie_id:movie_id}):\"\"));}}]);return MoviePage;}(Component);function mapStateToProps(_ref4){var global=_ref4.global;return{global:global};}export default withRouter(connect(mapStateToProps,actions)(MoviePage));","map":{"version":3,"sources":["/Users/denis/Desktop/projects/movies-app/client/src/components/movie-page/MoviePage.jsx"],"names":["React","Component","MOVIES_ROUTE","MOVIE_ROUTE","withRouter","connect","actions","MovieCredits","MovieRelated","MoviePageAbout","apiGetRequest","MoviePage","getMovieId","url","window","location","pathname","split","movie_id","length","props","match","params","id","getMovie","api","res","setState","movie","getVideo","then","video","results","key","handleActiveSection","active_section","closePage","active","setTimeout","close","history","pushState","back","from_movies","updateGlobalReducer","push","changeMovie","state","selected_movie","fade_out","name","value","map","m","i","mapStateToProps","global"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport \"./movie-page.css\";\nimport { MOVIES_ROUTE, MOVIE_ROUTE } from \"../../tools/routes\";\nimport { withRouter } from \"react-router-dom\";\nimport { connect } from \"react-redux\";\nimport * as actions from \"../../actions/actions\";\nimport MovieCredits from \"./sections/MovieCredits\";\nimport MovieRelated from \"./sections/MovieRelated\";\nimport MoviePageAbout from \"./parts/MoviePageAbout\";\nimport { apiGetRequest } from \"../../api/api\";\nclass MoviePage extends Component {\n  constructor() {\n    super();\n    this.state = {\n      movie: {},\n    };\n  }\n\n  getMovieId = () => {\n    let url = window.location.pathname.split('/')\n    let movie_id =url[url.length - 1] ? url[url.length - 1]  : this.props.match.params.id\n      \n      return movie_id\n  };\n\n  async componentWillMount() {\n    const { from_movies, selected_movie } = this.props;\n    let movie_id = this.getMovieId()\n    if (from_movies) {\n      setTimeout(() => {\n        this.setState({\n          active: true,\n        });\n      }, 50);\n    } else {\n      this.setState({\n        active: true,\n      });\n    }\n    this.setState({\n      movie_id,\n    });\n      await this.getMovie(movie_id)\n    setTimeout(() => {\n      this.getVideo(movie_id)\n    }, 400);\n  }\n  getMovie = async (movie_id) => {\n    const api = `movie/${movie_id}`;\n    const res = await apiGetRequest(api);\n    if (res) {\n      this.setState({\n        movie: res,\n      });\n    }\n  };\n\n  getVideo = async (movie_id) => {\n    const api = `movie/${movie_id}/videos`;\n    await apiGetRequest(api).then((res) => {\n      this.setState({\n        video: res && res.results[0] ? res.results[0].key : \"\",\n      });\n    });\n  };\n\n  handleActiveSection = (active_section) => {\n    this.setState({\n      active_section,\n    });\n  };\n\n  closePage = () => {\n    this.setState({\n      active: false,\n    });\n    setTimeout(() => {\n      this.props.close();\n      window.history.pushState(\"/\", \"/\", `/`);\n    }, 300);\n  };\n\n  back = () => {\n    const { from_movies } = this.props;\n    if (from_movies) {\n      this.closePage();\n      this.props.updateGlobalReducer(\"pause_movie\", false);\n    } else this.props.history.push(MOVIES_ROUTE);\n  };\n  changeMovie = async(id) => {\n    await this.getMovie(id)\n    setTimeout(() => {\n      this.getVideo(id)\n    }, 400);\n    this.setState({\n      movie_id:id\n    })\n  };\n  render() {\n    const { active, movie, active_section, movie_id, fade_out, video } = this.state;\n    const actions = [\n      {\n        name: \"Reviews\",\n        value: \"reviews\",\n      },\n      {\n        name: \"Credits\",\n        value: \"credits\",\n      },\n      {\n        name: \"Related\",\n        value: \"similar\",\n      },\n    ];\n\n    return (\n      <div id={active ? \"movie__page--active\" : \"\"} className=\"movie__page\">\n        <section className=\"movie__page__overlay\"> </section>\n        <button onClick={() => this.back()}>X</button>\n\n        {<MoviePageAbout fade_out={fade_out} movie_id={movie_id} movie = {movie} video = {video}  />}\n\n        <ul className=\"movie__page__actions flex__center\">\n          {actions.map((m, i) => {\n            return (\n              <li onClick={() => this.handleActiveSection(m.value)}>\n                {m.name}\n              </li>\n            );\n          })}\n        </ul>\n        <div className=\"movie__page__content\">\n          { active_section === \"credits\" ? (\n            <MovieCredits movie_id={movie_id} />\n          ) : active_section === \"similar\" ? (\n            <MovieRelated changeMovie={this.changeMovie} movie_id={movie_id} />\n          ) : (\n            \"\"\n          )}\n        </div>\n      </div>\n    );\n  }\n}\n\nfunction mapStateToProps({ global }) {\n  return { global };\n}\n\nexport default withRouter(connect(mapStateToProps, actions)(MoviePage));\n"]},"metadata":{},"sourceType":"module"}